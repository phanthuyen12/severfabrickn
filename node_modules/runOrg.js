const path = require('path');
const { exec } = require('child_process');

function runShellScript(req, res) {
  const value = req.body.value; // Nhận giá trị từ yêu cầu

  console.log(value);

  if (value === undefined) {
    return res.status(400).json({ error: 'No value provided' });
  }

  // Đường dẫn đến file .sh
  const scriptPath = path.join(__dirname,'../' ,'tudong.sh');

  // Chạy shell script với giá trị truyền vào
  exec(`bash ${scriptPath} ${value}`, (error, stdout, stderr) => {
    if (error) {
      console.error(`exec error: ${error}`);
      return res.status(500).json({ error: 'Script execution failed', details: stderr });
    }
    
    // Trả về kết quả khi script hoàn tất
    console.log('Script executed successfully');
    res.json({ status: "true", output: stdout });
  });
}

module.exports = runShellScript;
